# Chrome Audio Device Isolation Configuration
# Hides hardware devices from Chrome, keeping only virtual intercom devices
# Based on WirePlumber 0.5+ configuration format

# Disable hardware audio devices globally
# This ensures Chrome only sees virtual devices for proper isolation
monitor.alsa.rules = [
  {
    # Disable CSCTEK USB Audio hardware
    matches = [
      {
        node.name = "alsa_output.usb-CSCTEK_USB_Audio_and_HID_A34004801402-00.analog-stereo"
      }
    ]
    actions = {
      update-props = {
        node.disabled = true
      }
    }
  },
  {
    # Disable CSCTEK USB Audio input hardware
    matches = [
      {
        node.name = "alsa_input.usb-CSCTEK_USB_Audio_and_HID_A34004801402-00.mono-fallback"
      }
    ]
    actions = {
      update-props = {
        node.disabled = true
      }
    }
  },
  {
    # Disable HDMI audio output
    matches = [
      {
        node.name = "alsa_output.pci-0000_00_1f.3.hdmi-stereo"
      }
    ]
    actions = {
      update-props = {
        node.disabled = true
      }
    }
  },
  {
    # Disable NZXT capture device
    matches = [
      {
        node.name = "alsa_input.usb-NZXT_NZXT_Signal_HD60_Video_856B012010700273-02.analog-stereo"
      }
    ]
    actions = {
      update-props = {
        node.disabled = true
      }
    }
  },
  {
    # Disable usb_audio_source (duplicate from audio manager)
    matches = [
      {
        node.name = "usb_audio_source"
      }
    ]
    actions = {
      update-props = {
        node.disabled = true
      }
    }
  }
]

  },
  {
    # Hide intercom-mic-sink from Chrome (routing helper only)  
    matches = [
      {
        node.name = "intercom-mic-sink"
      }
    ]
    actions = {
      update-props = {
        node.disabled = true
      }
    }
  },
  {
    # Hide ALL monitor sources (not needed for Chrome)
    matches = [
      {
        node.name = "intercom-speaker.monitor"
      }
    ]
    actions = {
      update-props = {
        node.disabled = true
      }
    }
  },
  {
    matches = [
      {
        node.name = "intercom-mic-sink.monitor"
      }
    ]
    actions = {
      update-props = {
        node.disabled = true
      }
    }
  }
]

# Final result: Chrome should only see:
# - intercom-speaker (speaker output)
# - output.intercom-microphone (microphone input)
# Total: 2 devices (exactly what tests expect)