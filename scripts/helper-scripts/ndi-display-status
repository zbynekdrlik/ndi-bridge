#!/bin/bash
#
# NDI Display Status - Show current NDI stream to display mappings
#

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo "================================"
echo "    NDI Display Status"
echo "================================"
echo

# Check if service is running
if systemctl is-active --quiet ndi-display; then
    echo -e "${GREEN}● ndi-display.service is running${NC}"
    echo
    
    # Show current mappings
    echo "Current Stream Mappings:"
    echo "------------------------"
    /usr/local/bin/ndi-display status 2>/dev/null || echo "No active mappings"
    echo
    
    # Show display information
    echo "Available Displays:"
    echo "------------------"
    /usr/local/bin/ndi-display displays
    echo
    
    # Show recent logs
    echo "Recent Activity:"
    echo "---------------"
    journalctl -u ndi-display -n 10 --no-pager
else
    echo -e "${RED}● ndi-display.service is not running${NC}"
    echo
    echo "Start the service with: sudo systemctl start ndi-display"
fi

echo
echo "Available Commands:"
echo "  ndi-display-list     - List available NDI streams"
echo "  ndi-display-show     - Map a stream to a display"
echo "  ndi-display-stop     - Stop displaying on a specific output"
echo "  ndi-display-auto     - Auto-map streams to displays"