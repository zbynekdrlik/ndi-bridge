# Chrome Audio Isolation Configuration
# This configuration ensures Chrome ONLY sees virtual intercom devices

# Define access rules for Chrome clients
context.access = [
    {
        # Match Chrome by application name
        matches = [
            { application.name = "~Google Chrome.*" }
            { application.name = "~chrome.*" }
            { application.process.binary = "~.*chrome.*" }
        ]
        
        # Set default permissions - start with no access
        default.permissions = "---"
        
        # Then grant specific access to virtual devices only
        items = [
            {
                matches = [
                    { node.name = "intercom-speaker" }
                    { node.name = "intercom-microphone" }
                ]
                permissions = "rwx"
            }
        ]
    }
]

# Hide hardware devices from Chrome
filter.hide = [
    {
        matches = [
            { application.name = "~Google Chrome.*" }
            { application.name = "~chrome.*" }
        ]
        
        # Hide these patterns from Chrome
        items = [
            { node.name = "~.*usb.*" }
            { node.name = "~.*USB.*" }
            { node.name = "~.*CSCTEK.*" }
            { node.name = "~.*hdmi.*" }
            { node.name = "~.*HDMI.*" }
            { node.description = "~.*USB.*" }
            { node.description = "~.*HDMI.*" }
        ]
    }
]