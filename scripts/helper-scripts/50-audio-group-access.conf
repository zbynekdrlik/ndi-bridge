# PipeWire configuration to allow audio group access
# This enables the intercom user to connect to system PipeWire

# Override socket permissions to allow audio group
context.modules = [
    { name = libpipewire-module-protocol-native
        args = {
            # Socket permissions for audio group
            sockets = [
                { 
                    name = "pipewire-0"
                    mode = "0666"  # Allow all users to connect
                }
                {
                    name = "pipewire-0-manager"
                    mode = "0666"  # Allow all users to connect
                }
            ]
        }
        flags = [ override ]  # Override the main config
    }
]

# Ensure PulseAudio compatibility socket is also accessible
context.exec = [
    { path = "pipewire-pulse"
        args = "--socket-mode=0666"
    }
]